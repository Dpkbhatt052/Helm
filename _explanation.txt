
{{- define "helloworld.name" -}}
{{- default .Chart.Name .Values.nameOverride | trunc 63 | trimSuffix "-" }}
{{- end }}

In Helm, the default function is a template function that provides a fallback value when the specified value is empty or undefined. It takes two arguments:

Syntax:

This is commonly used for generating resource names in Kubernetes manifests that comply with naming conventions and limitations.

Example:

If Chart.Name is "my-application" and no nameOverride is set, it outputs: "my-application"
If nameOverride is set to "custom-name", it outputs: "custom-name"
If the name is very long, it will be truncated to 63 characters

    
default DEFAULT_VALUE VALUE_TO_CHECK

    

    
Here are some examples to illustrate how it works:

Basic usage:
    
# If .Values.service.port is not defined, use 80
port: {{ default 80 .Values.service.port }}

    

    
With strings:
    
# If .Values.name is not defined, use "default-name"
name: {{ default "default-name" .Values.name }}

    

    
Real-world example from a deployment:
    
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ default .Chart.Name .Values.nameOverride }}
  labels:
    app: {{ default .Chart.Name .Values.nameOverride }}

``````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````
{{- if contains $name .Release.Name }}
  {{- .Release.Name | trunc 63 | trimSuffix "-" }}
{{- else }}
  {{- printf "%s-%s" .Release.Name $name | trunc 63 | trimSuffix "-" }}
{{- end }}

Let's analyze each part:

if contains $name .Release.Name

contains is a function that checks if one string is contained within another
Checks if $name (a variable) is already part of .Release.Name
If condition is TRUE (i.e., $name is already in .Release.Name):

Returns .Release.Name after:
truncating to 63 characters (trunc 63)
removing trailing dash (trimSuffix "-")
If condition is FALSE (i.e., $name is not in .Release.Name):

Uses printf "%s-%s" to combine:
.Release.Name
$name
Separated by a hyphen
Then truncates to 63 characters
Removes trailing dash
Example scenarios:

If $name = "nginx" and .Release.Name = "my-nginx":
    
# Contains "nginx", so returns just the Release.Name
Result: "my-nginx"

    

    
If $name = "nginx" and .Release.Name = "myapp":
    
# Doesn't contain "nginx", so combines both
Result: "myapp-nginx"
